<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataSerendipity - Gallery</title>
    <link rel="stylesheet" href="/static/css/navigation_style.css">
    <link rel="stylesheet" href="/static/css/gallery_style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js"></script>
</head>
<body>
    <!-- Navigation Bar -->
    <nav>
        <div class="logo-container">
            <img src="/static/images/Serendipity_logo.jpg" alt="DataSerendipity Logo">
            <span>DataSerendipity</span>
        </div>
        <ul>
            <li><a href="/" class="btn">Home</a></li>
            <li><a href="/about" class="btn">About</a></li>
            <li><a href="/services" class="btn">Services</a></li>
            <li><a href="/gallery" class="btn">Gallery</a></li>
            <li class="dropdown">
                <a href="/games" class="btn">Games â–¼</a>
                <ul class="dropdown-menu">
                    <li><a href="/games/plinko">Plinko</a></li>
                </ul>
            </li>
            <li><a href="/contact" class="btn">Contact</a></li>
        </ul>
    </nav>

    <!-- Sub-menu for Gallery -->
    <div class="gallery-menu">
        <button class="tab-button" onclick="showTab('ticker-content')">AEX Tickers</button>
        <button class="tab-button" onclick="showTab('stock-data')">Stocks Data</button>
    </div>

    <!-- AEX Ticker Dashboard -->
    <section id="ticker-content" class="tab-content">
        <h1>AEX Index Ticker Symbols</h1>
        <div class="ticker-dashboard">
            <div class="table-container">
                <table id="ticker-table">
                    <thead>
                        <tr>
                            <th>Ticker Symbol</th>
                            <th>Last Updated</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </section>

    <script>
    function fetchTickers() {
        fetch('/api/tickers')
            .then(response => response.json())
            .then(data => {
                const tableBody = document.querySelector('#ticker-table tbody');
                tableBody.innerHTML = ""; 

                data.forEach(entry => {
                    let row = document.createElement('tr');
                    row.innerHTML = `<td>${entry["Ticker Symbol"]}</td><td>${entry["Last Updated"]}</td>`;
                    tableBody.appendChild(row);
                });
            })
            .catch(error => console.error('Error fetching tickers:', error));
    }

    document.addEventListener("DOMContentLoaded", fetchTickers);
    </script>

    <script>
        function showTab(tabId) {
            // Hide both sections first
            document.getElementById('ticker-content').style.display = 'none';
            document.getElementById('stock-data').style.display = 'none';

            // Show the selected section
            document.getElementById(tabId).style.display = 'block';
        }

        // Ensure both sections are hidden when the page first loads
        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById("ticker-content").style.display = "none";
            document.getElementById("stock-data").style.display = "none";
        });

    </script>

    <!-- Stock Data Download Table -->
    <section id="stock-data" class="tab-content">
        <h1>AEX Stock Data Download History</h1>
        <div class="stock-dashboard">
            <div class="table-container">
                <table id="stock-data-table">
                    <thead>
                        <tr>
                            <th>Ticker Symbol</th>
                            <th>Start Date</th>
                            <th>End Date</th>
                            <th>Downloaded At</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </section>

    <script>
    function fetchStockData() {
    fetch('/api/stock_data')
        .then(response => response.json())
        .then(data => {
            const tableBody = document.querySelector('#stock-data-table tbody');
            tableBody.innerHTML = "";

            if (data.error) {
                console.error("API Error:", data.error);
                return;
            }

            data.forEach(entry => {
                let row = document.createElement('tr');
                row.innerHTML = `<td>${entry["Ticker Symbol"] || "N/A"}</td>
                                 <td>${entry["Start Date"] || "N/A"}</td>
                                 <td>${entry["End Date"] || "N/A"}</td>
                                 <td>${entry["Downloaded At"] || "N/A"}</td>`;
                tableBody.appendChild(row);
            });
        })
        .catch(error => console.error('Error fetching stock data:', error));
    }

    // Fetch stock data on page load
    document.addEventListener("DOMContentLoaded", fetchStockData);
    </script>

</body>
</html>
